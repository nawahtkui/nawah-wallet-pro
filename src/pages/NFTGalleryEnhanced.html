<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Ù…Ø¹Ø±Ø¶ NFTs | Nawah Wallet</title>
  <link rel="stylesheet" href="NFTGalleryEnhanced.css" />
</head>
<body>
  <header>
    <h1>ğŸª™ Ù…Ø¹Ø±Ø¶ Ù†ÙˆØ§Ø© NFT</h1>
    <p>Ø§Ø³ØªØ¹Ø±Ø¶ Ø±Ù…ÙˆØ²Ùƒ Ø§Ù„ÙØ±ÙŠØ¯Ø© Ù…Ù† Ù…Ø´Ø±ÙˆØ¹ Ù†ÙˆØ§Ø© Ù…Ø¨Ø§Ø´Ø±Ø© Ø¹Ø¨Ø± ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø­ÙØ¸Ø©</p>
  </header>

  <section class="controls">
    <input type="text" id="searchBox" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† NFT Ø¨Ø§Ù„Ø§Ø³Ù…..." />
    <select id="rarityFilter">
      <option value="">ÙƒÙ„ Ø§Ù„Ù†Ø¯Ø±Ø§Øª</option>
      <option value="legendary">Ø£Ø³Ø·ÙˆØ±ÙŠ</option>
      <option value="rare">Ù†Ø§Ø¯Ø±</option>
      <option value="common">Ø¹Ø§Ø¯ÙŠ</option>
    </select>
    <button id="refreshBtn">ğŸ”„ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
  </section>

  <main class="container">
    <div id="gallery" class="grid"></div>
  </main>

  <!-- Lightbox -->
  <div id="lightbox">
    <img id="lbimg" src="" alt="NFT Full View" />
  </div>

  <script>
    // ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª NFTs Ù…Ù† Ù…Ù„Ù JSON
    async function loadNFTs() {
      const response = await fetch('nft_frontend.json');
      const data = await response.json();
      return data;
    }

    function renderGallery(nfts) {
      const gallery = document.getElementById('gallery');
      gallery.innerHTML = '';
      nfts.forEach(nft => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img src="${nft.image}" alt="${nft.name}" class="thumb" onclick="openLightbox('${nft.image}')">
          <div class="meta">
            <h3>${nft.name}</h3>
            <div class="desc">${nft.description || 'Ø±Ù…Ø² Ø±Ù‚Ù…ÙŠ ÙØ±ÙŠØ¯ Ù…Ù† Ù†ÙˆØ§Ø©'}</div>
            <div class="row">
              <span class="badge ${nft.rarity || 'common'}">${nft.rarity || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯'}</span>
              <span>Ø§Ù„Ù†Ø¯Ø±Ø©</span>
            </div>
            <div class="row">
              <span>ğŸ”¢ Ø§Ù„Ù…Ø¹Ø±Ù:</span>
              <span>#${nft.id}</span>
            </div>
            <div class="actions">
              <button class="action-btn" onclick="copyMetadata(${nft.id})">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
              <button class="action-btn" onclick="viewOnchain(${nft.id})">ğŸ”— Ø¹Ù„Ù‰ Ø§Ù„Ø¨Ù„ÙˆÙƒØ´ÙŠÙ†</button>
            </div>
          </div>
        `;
        gallery.appendChild(card);
      });
    }

    function openLightbox(imgSrc) {
      const lb = document.getElementById('lightbox');
      const lbimg = document.getElementById('lbimg');
      lbimg.src = imgSrc;
      lb.classList.add('open');
    }

    document.getElementById('lightbox').addEventListener('click', () => {
      document.getElementById('lightbox').classList.remove('open');
    });

    function copyMetadata(id) {
      navigator.clipboard.writeText(`NFT ID: ${id}`).then(() => {
        alert('âœ… ØªÙ… Ù†Ø³Ø® Ù…Ø¹Ø±Ù Ø§Ù„Ù€NFT Ø¥Ù„Ù‰ Ø§Ù„Ø­Ø§ÙØ¸Ø©');
      });
    }

    function viewOnchain(id) {
      const url = `https://testnet.bscscan.com/token/<YOUR_CONTRACT_ADDRESS>?a=${id}`;
      window.open(url, '_blank');
    }

    // ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ØªØµÙÙŠØ©
    function applyFilters(nfts) {
      const searchTerm = document.getElementById('searchBox').value.toLowerCase();
      const rarity = document.getElementById('rarityFilter').value;
      return nfts.filter(nft =>
        (!searchTerm || nft.name.toLowerCase().includes(searchTerm)) &&
        (!rarity || nft.rarity === rarity)
      );
    }

    // ØªØ­Ù…ÙŠÙ„ ÙˆØªØ­Ø¯ÙŠØ«
    let nftData = [];
    async function initGallery() {
      nftData = await loadNFTs();
      renderGallery(nftData);
    }

    document.getElementById('refreshBtn').addEventListener('click', () => {
      const filtered = applyFilters(nftData);
      renderGallery(filtered);
    });

    document.getElementById('searchBox').addEventListener('input', () => {
      const filtered = applyFilters(nftData);
      renderGallery(filtered);
    });

    document.getElementById('rarityFilter').addEventListener('change', () => {
      const filtered = applyFilters(nftData);
      renderGallery(filtered);
    });

    initGallery();
  </script>
</body>
</html>
